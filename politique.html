<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>Infinie & gratuit ‚Äî G√©n√©rateur de pages l√©gales e-commerce</title>
  <meta name="color-scheme" content="dark"/>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">
  <!-- jsPDF pour export PDF -->
  <script defer src="https://cdn.jsdelivr.net/npm/jspdf@2.5.1/dist/jspdf.umd.min.js"></script>
  <style>
    :root{
      --bg:#0B0B0D; --panel:#0d1120; --text:#E6ECF7; --muted:#A4ADBD;
      --border:rgba(95,123,255,0.18);
      --accent1:#2FE3FF; --accent2:#1B4CFF;
      --ring:0 0 0 2px rgba(43,167,255,.35);
      --input-bg:#0b0f1a; --input-bd:#1a2340;
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; font-family:Inter,system-ui,Segoe UI,Roboto,Arial,Apple Color Emoji,Segoe UI Emoji;
      background:
        radial-gradient(1200px 600px at 8% 12%, rgba(43,167,255,0.12), transparent 60%),
        radial-gradient(1000px 800px at 82% 85%, rgba(27,76,255,0.10), transparent 55%),
        var(--bg);
      color:var(--text);
    }
    .wrap{max-width:1100px; margin:0 auto; padding:32px 20px 80px}

    /* Header logo */
    .brand{display:flex; align-items:center; gap:10px; user-select:none}
    .brand .badge{
      width:36px; height:36px; border-radius:999px; display:grid; place-items:center;
      background:radial-gradient(120% 120% at 20% 20%, var(--accent1), var(--accent2));
      box-shadow:0 0 0 1px rgba(255,255,255,0.06), 0 10px 30px rgba(33,118,255,.25) inset;
    }
    .brand .badge span{font-weight:800; font-size:20px; color:white; transform:translateY(-1px)}
    .brand .word{font-weight:800; letter-spacing:.2px; font-size:16px; color:var(--text); opacity:.95}

    /* Card/panel */
    .card{
      position:relative; background:linear-gradient(160deg, rgba(27,76,255,0.06), transparent),
                          linear-gradient(180deg, rgba(47,227,255,0.05), transparent 40%),
                          var(--panel);
      border:1px solid var(--border); border-radius:var(--radius);
      box-shadow:0 15px 50px rgba(0,0,0,.35), 0 0 0 1px rgba(255,255,255,.03) inset;
      padding:22px; overflow:hidden;
    }
    .card.sheen::after{
      content:""; position:absolute; inset:-40% -80%; transform:rotate(8deg);
      background:linear-gradient(90deg, transparent, rgba(255,255,255,.06), transparent);
      animation:sheen 5s linear infinite;
      pointer-events:none; /* IMPORTANT: clics jamais bloqu√©s */
    }
    @keyframes sheen{0%{transform:translateX(-40%) rotate(8deg)}100%{transform:translateX(40%) rotate(8deg)}}

    h1{font-size:28px; margin:8px 0 6px}
    p.lead{color:var(--muted); margin:0 0 14px; line-height:1.6}

    /* Buttons */
    .row-actions{display:flex; gap:12px; flex-wrap:wrap}
    .btn{
      appearance:none; border:0; border-radius:14px; padding:12px 16px;
      font-weight:700; color:white; cursor:pointer; transition:.2s ease transform, .2s ease box-shadow, .2s ease background;
      display:inline-flex; align-items:center; gap:10px;
      box-shadow:0 8px 24px rgba(0,0,0,.25);
      will-change:transform;
    }
    .btn:focus{outline:none; box-shadow:0 0 0 3px rgba(43,167,255,.35)}
    .btn:hover{transform:translateY(-1px)}
    .btn:active{transform:translateY(0)}
    .btn.primary{background:linear-gradient(135deg, var(--accent1), var(--accent2))}
    .btn.ghost{background:transparent; color:var(--text); border:1px solid var(--border)}
    .btn.small{padding:10px 12px; font-weight:600; border-radius:12px; font-size:13px}

    /* Steps */
    .stack{display:grid; gap:16px; margin-top:18px}
    .hidden{display:none !important}

    /* Info panel (collapsible) */
    .info-wrap{overflow:hidden; transition:max-height .35s ease, opacity .35s ease; max-height:0; opacity:0}
    .info-wrap.open{max-height:900px; opacity:1}
    .info-grid{display:grid; gap:12px}
    @media(min-width:760px){ .info-grid{grid-template-columns:repeat(2,1fr)} }
    .info-item{display:flex; gap:12px; padding:12px; border:1px solid var(--border); border-radius:14px; background:rgba(12,16,28,.6)}
    .icon{width:28px; height:28px; flex:0 0 28px}
    .info-item h3{margin:0 0 6px; font-size:14px}
    .info-item p{margin:0; font-size:13px; color:var(--muted)}
    .info-item ul{margin:6px 0 0 18px; padding:0; color:#cfe7ff; font-size:13px}
    .info-item li{margin:2px 0}

    /* Form */
    .form{display:grid; gap:18px}
    .fieldset{border:1px dashed rgba(95,123,255,.25); border-radius:14px; padding:16px}
    .legend{font-weight:700; font-size:13px; color:#cfe7ff; letter-spacing:.2px; text-transform:uppercase; margin-bottom:12px}
    .grid{display:grid; gap:12px}
    @media(min-width:760px){ .grid.cols-2{grid-template-columns:1fr 1fr} .grid.cols-3{grid-template-columns:repeat(3,1fr)} }
    label{display:block; font-size:12px; color:var(--muted); margin-bottom:6px}
    input, textarea, select{
      width:100%; background:var(--input-bg); border:1px solid var(--input-bd);
      color:var(--text); border-radius:12px; padding:12px 12px; font:inherit; outline:none;
      transition:.2s ease border-color, .2s ease box-shadow, .2s ease background;
    }
    input:focus, textarea:focus, select:focus{box-shadow:var(--ring); border-color:#2b5cff}
    textarea{min-height:90px; resize:vertical}

    .hint{font-size:12px; color:var(--muted)}
    .err{font-size:12px; color:#ff6b6b; margin-top:6px; display:none}

    /* Generator overlay */
    .loading{
      display:flex; align-items:center; gap:14px; padding:14px; border-radius:12px;
      background:rgba(21,28,46,.65); border:1px solid rgba(95,123,255,.25);
    }
    .spinner{
      width:22px; height:22px; border-radius:50%;
      border:3px solid rgba(255,255,255,.12);
      border-top-color:transparent; position:relative;
      animation:spin .9s linear infinite;
    }
    .spinner::after{
      content:""; position:absolute; inset:-3px; border-radius:50%;
      border:3px solid transparent;
      border-top-color:#6bd8ff; filter:drop-shadow(0 0 8px rgba(47,227,255,.65));
      animation:spin 1.2s linear infinite reverse;
    }
    @keyframes spin{to{transform:rotate(360deg)}}

    .stage{margin-top:14px}
    .stage .dot{width:8px; height:8px; border-radius:999px; background:linear-gradient(135deg,var(--accent1),var(--accent2)); display:inline-block; box-shadow:0 0 12px rgba(33,118,255,.6)}
    .stage p{margin:6px 0 0; font-size:13px; color:#cde9ff}

    /* Result list */
    .doc-list{display:grid; gap:10px; margin-top:8px}
    .doc-item{
      display:flex; align-items:center; justify-content:space-between; gap:12px;
      padding:12px; border:1px solid var(--border); border-radius:12px; background:rgba(12,16,28,.6)
    }
    .doc-title{font-weight:700}
    .doc-actions{display:flex; gap:8px; flex-wrap:wrap}

    .note{font-size:12px; color:var(--muted); margin-top:8px}
    .footer-space{height:24px}
  </style>
</head>
<body>
  <div class="wrap">
    <header class="brand" aria-label="Infinie & gratuit">
      <div class="badge"><span>‚àû</span></div>
      <div class="word">Infinie & gratuit</div>
    </header>

    <main class="stack">
      <!-- √âTAT 1 ‚Äî Bienvenue -->
      <section id="welcome" class="card sheen">
        <h1>G√©n√©rateur de pages l√©gales e-commerce</h1>
        <p class="lead">
          Cr√©e en quelques minutes tes <strong>CGV</strong>, <strong>CGU</strong>, <strong>Mentions l√©gales</strong> et ta page <strong>SAV</strong>, pr√™tes √† √™tre t√©l√©charg√©es en <em>.txt</em> ou <em>.pdf</em>.
          Aucune inscription. Z√©ro pub. 100% local.
        </p>
        <div class="row-actions">
          <button class="btn primary" id="start">‚ûï Cr√©er mes pages</button>
          <button class="btn ghost" id="seeFields" aria-expanded="false" aria-controls="infoCard">‚ÑπÔ∏è Voir les infos requises</button>
        </div>

        <!-- Cadre infos requises (collapsible) -->
        <div id="infoCard" class="info-wrap" aria-hidden="true">
          <div class="info-grid" style="margin-top:14px">
            <!-- Identit√© -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M12 12a4 4 0 1 0-4-4 4 4 0 0 0 4 4Zm0 2c-4 0-7 2-7 4v1h14v-1c0-2-3-4-7-4Z" stroke="url(#g1)" stroke-width="1.6"/>
                <defs><linearGradient id="g1" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>Identit√© & contacts</h3>
                <p>Nom boutique, entit√©, SIREN/SIRET, RCS, capital, adresse, responsable de publication, email/t√©l√©phone, URL du site.</p>
                <ul><li>Ex: ‚ÄúATELIER SAS‚Äù, ‚ÄúRCS Paris‚Äù, ‚ÄúFR TVA ‚Ä¶‚Äù</li></ul>
              </div>
            </div>
            <!-- H√©bergeur -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M4 7h16v4H4zM4 13h16v4H4zM7 9h4M7 15h4" stroke="url(#g2)" stroke-width="1.6" stroke-linecap="round"/>
                <defs><linearGradient id="g2" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>H√©bergement</h3>
                <p>Nom et adresse postale de l‚Äôh√©bergeur du site (obligatoire).</p>
                <ul><li>Ex: ‚ÄúHostinger International Ltd., ‚Ä¶‚Äù</li></ul>
              </div>
            </div>
            <!-- Vente & paiement -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M3 6h18v4H3zM3 10h18v8H3zM7 14h4" stroke="url(#g3)" stroke-width="1.6" stroke-linecap="round"/>
                <defs><linearGradient id="g3" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>Vente & paiement</h3>
                <p>Moyens de paiement, lutte anti-fraude, devises, taxes, facturation.</p>
                <ul><li>CB, Visa, Mastercard, PayPal, etc.</li></ul>
              </div>
            </div>
            <!-- Livraison -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M3 16h2l2-6h9l2 6h3M7 20a2 2 0 1 0 0-4 2 2 0 0 0 0 4Zm10 0a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z" stroke="url(#g4)" stroke-width="1.6" stroke-linecap="round"/>
                <defs><linearGradient id="g4" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>Livraison</h3>
                <p>Zones desservies, d√©lais, transporteurs, frais, suivi, transfert des risques.</p>
              </div>
            </div>
            <!-- Retours & SAV -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M12 6v6l4 2M4 12a8 8 0 1 0 8-8" stroke="url(#g5)" stroke-width="1.6" stroke-linecap="round"/>
                <defs><linearGradient id="g5" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>Retours & SAV</h3>
                <p>Droit de r√©tractation (jours), fen√™tre de retour, adresse, proc√©dure SAV, d√©lais.</p>
              </div>
            </div>
            <!-- Juridique / RGPD -->
            <div class="info-item">
              <svg class="icon" viewBox="0 0 24 24" fill="none">
                <path d="M12 3l7 4v5c0 5-3.5 8-7 9-3.5-1-7-4-7-9V7l7-4Z" stroke="url(#g6)" stroke-width="1.6"/>
                <defs><linearGradient id="g6" x1="0" y1="0" x2="24" y2="24"><stop stop-color="#2FE3FF"/><stop offset="1" stop-color="#1B4CFF"/></linearGradient></defs>
              </svg>
              <div>
                <h3>Juridique & RGPD</h3>
                <p>Droit applicable, tribunal comp√©tent, contact RGPD/DPO, cookies, m√©diation/ODR.</p>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- √âTAT 2 ‚Äî Formulaire (identique √† avant) -->
      <section id="formCard" class="card hidden">
        <h1>Renseigne les informations</h1>
        <p class="lead">Nous g√©n√©rons des mod√®les conformes au cadre FR/EU (√† adapter √† ton activit√©). Champs essentiels marqu√©s d‚Äôun *.</p>

        <form class="form" id="legalForm" novalidate>
          <!-- Identit√© l√©gale -->
          <div class="fieldset">
            <div class="legend">Identit√©</div>
            <div class="grid cols-2">
              <div>
                <label>Nom de la boutique *</label>
                <input required name="shopName" placeholder="Ex: L'Atelier des √âtoiles"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>URL du site *</label>
                <input required name="siteUrl" placeholder="https://exemple.com"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>Raison sociale / forme *</label>
                <input required name="entity" placeholder="Ex: ATELIER SAS"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>Capital social</label>
                <input name="capital" placeholder="Ex: 10 000 ‚Ç¨"/>
              </div>
              <div>
                <label>SIREN / SIRET *</label>
                <input required name="siren" placeholder="Ex: 123 456 789"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>RCS (ville) *</label>
                <input required name="rcs" placeholder="Ex: RCS Paris"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>TVA intracommunautaire</label>
                <input name="tva" placeholder="Ex: FR12 123456789"/>
              </div>
              <div>
                <label>Si√®ge social (Adresse) *</label>
                <input required name="hqAddress" placeholder="N¬∞, rue, code postal, ville, pays"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>Responsable de la publication *</label>
                <input required name="publisher" placeholder="Nom Pr√©nom"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>Email de contact *</label>
                <input required name="email" placeholder="support@exemple.com"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>T√©l√©phone</label>
                <input name="phone" placeholder="+33 ..."/>
              </div>
            </div>
            <p class="hint">Ces infos alimentent les <em>mentions l√©gales</em>, les CGV/CGU et la page SAV.</p>
          </div>

          <!-- H√©bergeur -->
          <div class="fieldset">
            <div class="legend">H√©bergement</div>
            <div class="grid cols-2">
              <div>
                <label>H√©bergeur (nom) *</label>
                <input required name="hostName" placeholder="Ex: Hostinger International Ltd."/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>H√©bergeur (adresse) *</label>
                <input required name="hostAddress" placeholder="Adresse compl√®te"/>
                <div class="err">Requis</div>
              </div>
            </div>
          </div>

          <!-- Vente & livraison -->
          <div class="fieldset">
            <div class="legend">Vente & Livraison</div>
            <div class="grid cols-2">
              <div>
                <label>Zones de livraison</label>
                <input name="zones" placeholder="France m√©tropolitaine, UE, ‚Ä¶"/>
              </div>
              <div>
                <label>D√©lais d‚Äôexp√©dition (indicatif)</label>
                <input name="shippingDelay" placeholder="Ex: 24‚Äì48h ouvr√©es"/>
              </div>
              <div>
                <label>Transporteurs</label>
                <input name="carriers" placeholder="Ex: Colissimo, Chronopost, DHL"/>
              </div>
              <div>
                <label>Frais de livraison</label>
                <input name="fees" placeholder="Ex: offerts d√®s 60 ‚Ç¨, sinon 4,90 ‚Ç¨"/>
              </div>
              <div>
                <label>Moyens de paiement accept√©s</label>
                <input name="payments" placeholder="CB, Visa, Mastercard, PayPal, Apple Pay‚Ä¶"/>
              </div>
            </div>
          </div>

          <!-- Retours & SAV -->
          <div class="fieldset">
            <div class="legend">Retours & SAV</div>
            <div class="grid cols-2">
              <div>
                <label>Droit de r√©tractation (jours, EU = 14) *</label>
                <input required name="withdrawalDays" type="number" min="1" value="14"/>
                <div class="err">Requis</div>
              </div>
              <div>
                <label>D√©lai de retour (si diff√©rent)</label>
                <input name="returnWindow" placeholder="Ex: 30 jours"/>
              </div>
              <div>
                <label>Adresse de retour</label>
                <input name="returnAddress" placeholder="Adresse de retour"/>
              </div>
              <div>
                <label>Horaires SAV</label>
                <input name="savHours" placeholder="Ex: Lun‚ÄìVen, 9h‚Äì18h (CET)"/>
              </div>
            </div>
            <label>Proc√©dure SAV (optionnelle)</label>
            <textarea name="savProcess" placeholder="D√©crivez bri√®vement la proc√©dure (RMA, √©tapes, d√©lais, preuves n√©cessaires)‚Ä¶"></textarea>
          </div>

          <!-- Juridique -->
          <div class="fieldset">
            <div class="legend">Juridique</div>
            <div class="grid cols-3">
              <div>
                <label>Droit applicable</label>
                <select name="law">
                  <option value="fran√ßais" selected>Droit fran√ßais</option>
                  <option value="belge">Droit belge</option>
                  <option value="suisse">Droit suisse</option>
                  <option value="ue">Droit de l‚ÄôUnion europ√©enne</option>
                </select>
              </div>
              <div>
                <label>Tribunal comp√©tent</label>
                <input name="court" placeholder="Ex: Tribunaux de Paris"/>
              </div>
              <div>
                <label>Contact RGPD (si diff√©rent)</label>
                <input name="dpo" placeholder="Email DPO / contact donn√©es"/>
              </div>
            </div>
          </div>

          <div class="row-actions">
            <button type="button" class="btn ghost" id="backWelcome">‚Üê Retour</button>
            <button type="submit" class="btn primary">G√©n√©rer les 4 pages</button>
          </div>
          <div class="note">‚öñÔ∏è Mod√®les fournis √† titre indicatif ‚Äî fais valider par un professionnel si n√©cessaire.</div>
        </form>

        <!-- Animation de g√©n√©ration -->
        <div id="generator" class="stage hidden">
          <div class="loading">
            <div class="spinner" aria-hidden="true"></div>
            <div>
              <strong id="genStep">Analyse des informations‚Ä¶</strong>
              <div class="hint">Mise en forme et insertion des mentions obligatoires (UE/FR)‚Ä¶</div>
            </div>
          </div>
          <p class="stage"><span class="dot"></span> Merci de patienter ~ quelques secondes.</p>
        </div>
      </section>

      <!-- √âTAT 3 ‚Äî R√©sultat & t√©l√©chargements (identique) -->
      <section id="resultCard" class="card hidden">
        <h1>Merci pour ta confiance ‚ú®</h1>
        <p class="lead">Tes documents sont pr√™ts. T√©l√©charge-les en <em>.txt</em> ou <em>.pdf</em>. Tu peux reg√©n√©rer √† tout moment.</p>

        <div id="docList" class="doc-list"></div>

        <div class="row-actions" style="margin-top:12px">
          <button class="btn ghost" id="regen">‚Ü∫ Reg√©n√©rer</button>
          <button class="btn primary" id="backToStart">üè† Retour √† l‚Äôaccueil</button>
        </div>
        <div class="note">Derni√®re g√©n√©ration : <span id="genDate"></span></div>
      </section>

      <div class="footer-space"></div>
    </main>
  </div>

  <script>
    // Helpers
    const $ = sel => document.querySelector(sel);
    const show = (el, yes=true)=> el.classList[yes?'remove':'add']('hidden');
    const nowFr = ()=> new Date().toLocaleString('fr-FR',{dateStyle:'long', timeStyle:'short'});

    const S = {
      welcome: $('#welcome'),
      infoBtn: $('#seeFields'),
      infoCard: $('#infoCard'),
      formCard: $('#formCard'),
      form: $('#legalForm'),
      generator: $('#generator'),
      genStep: $('#genStep'),
      result: $('#resultCard'),
      docList: $('#docList'),
      genDate: $('#genDate'),
      // buttons
      start: $('#start'),
      backWelcome: $('#backWelcome'),
      regen: $('#regen'),
      backToStart: $('#backToStart'),
    };

    // √âtat initial
    S.start.addEventListener('click', () => {
      show(S.welcome,false); show(S.formCard,true);
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // Cadre infos requis ‚Äî toggle fluide
    S.infoBtn.addEventListener('click', () => {
      const open = !S.infoCard.classList.contains('open');
      S.infoCard.classList.toggle('open', open);
      S.infoBtn.setAttribute('aria-expanded', String(open));
      S.infoCard.setAttribute('aria-hidden', String(!open));
      // auto-scroll si on ouvre
      if(open){
        const y = S.infoCard.getBoundingClientRect().top + window.scrollY - 20;
        window.scrollTo({top:y, behavior:'smooth'});
      }
    });

    S.backWelcome.addEventListener('click', () => {
      show(S.formCard,false); show(S.welcome,true);
    });
    S.backToStart.addEventListener('click', () => {
      show(S.result,false); show(S.welcome,true);
    });
    S.regen.addEventListener('click', () => {
      show(S.result,false); show(S.formCard,true);
      window.scrollTo({top:0, behavior:'smooth'});
    });

    // Validation simple
    function validateRequired(form){
      let ok = true;
      form.querySelectorAll('[required]').forEach(inp=>{
        const block = inp.closest('div');
        const err = block?.querySelector('.err');
        if(!inp.value.trim()){
          ok = false;
          err && (err.style.display='block');
          inp.style.borderColor = '#ff6b6b';
          inp.addEventListener('input', ()=>{
            err && (err.style.display='none'); inp.style.borderColor = 'var(--input-bd)';
          }, {once:true});
        }
      });
      return ok;
    }

    // G√©n√©ration
    S.form.addEventListener('submit', async (e)=>{
      e.preventDefault();
      if(!validateRequired(S.form)) return;

      // Affiche le loader et simule des √©tapes
      show(S.generator,true);
      S.genStep.textContent = "Analyse des informations‚Ä¶";
      await sleep(650);
      S.genStep.textContent = "R√©daction des CGV & CGU‚Ä¶";
      await sleep(650);
      S.genStep.textContent = "Insertion des mentions l√©gales & SAV‚Ä¶";
      await sleep(650);

      // Compose les documents (versions longues)
      const data = getFormData(S.form);
      const docs = buildDocuments(data);

      // Remplit la carte de r√©sultat
      fillResults(docs);
      S.genDate.textContent = nowFr();

      // Bascule vers r√©sultat
      show(S.formCard,false);
      show(S.result,true);
      show(S.generator,false);
      window.scrollTo({top:0, behavior:'smooth'});
    });

    function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }
    function getFormData(form){
      const fd = new FormData(form);
      const obj = {};
      for (const [k,v] of fd.entries()) obj[k] = (v||"").toString().trim();
      obj.withdrawalDays = obj.withdrawalDays || "14";
      obj.returnWindow = obj.returnWindow || (obj.withdrawalDays ? obj.withdrawalDays+" jours" : "14 jours");
      return obj;
    }

    /* ====== G√âN√âRATION DES DOCUMENTS ‚Äî VERSION D√âTAILL√âE ====== */
    function buildDocuments(d){
      const date = new Date().toLocaleDateString('fr-FR',{year:'numeric', month:'long', day:'numeric'});
      const name = d.shopName || "Votre boutique";
      const site = d.siteUrl || "https://exemple.com";
      const tel = d.phone || "‚Äî";
      const court = d.court || "les tribunaux comp√©tents du ressort du si√®ge de l‚Äô√©diteur";

      const header = (title)=> `${title}\n${"=".repeat(title.length)}\nDerni√®re mise √† jour : ${date}\n√âditeur : ${d.entity} ‚Äî ${d.hqAddress}\nSite : ${site}\nEmail : ${d.email}${tel!=="‚Äî" ? " ‚Äî T√©l : "+tel : ""}\n\n`;

      /* Mentions l√©gales ‚Äî √©tendues */
      const mentions = header("Mentions l√©gales") +
`1) √âditeur du site
${d.entity}${d.capital?` ‚Äî Capital social : ${d.capital}`:""}${d.siren?` ‚Äî SIREN/SIRET : ${d.siren}`:""} ‚Äî ${d.rcs}${d.tva?` ‚Äî N¬∞ TVA : ${d.tva}`:""}
Si√®ge social : ${d.hqAddress}
Responsable de la publication : ${d.publisher}
Contact : ${d.email}${tel!=="‚Äî"?` ‚Äî ${tel}`:""}

2) H√©bergeur
${d.hostName}
${d.hostAddress}

3) Objet du site
Le site ${site} a pour objet la pr√©sentation et la vente de produits et/ou services propos√©s par ${d.entity}. 

4) Propri√©t√© intellectuelle
L‚Äôensemble des √©l√©ments du site (textes, images, graphismes, logos, marques, vid√©os, codes sources) est prot√©g√© par le droit d‚Äôauteur et/ou les droits de propri√©t√© intellectuelle. 
Toute reproduction, repr√©sentation, adaptation ou exploitation partielle ou totale, sans autorisation √©crite pr√©alable de ${d.entity}, est interdite.

5) Donn√©es personnelles
${d.entity} collecte et traite des donn√©es √† caract√®re personnel dans le cadre de la gestion des commandes, du support client et, le cas √©ch√©ant, de l‚Äôenvoi d‚Äôinformations commerciales. 
Base l√©gale : ex√©cution du contrat, int√©r√™t l√©gitime et obligations l√©gales. 
Dur√©es de conservation : limit√©es au strict n√©cessaire.
Droits des personnes (acc√®s, rectification, effacement, limitation, opposition, portabilit√©) : √©crire √† ${d.dpo || d.email}. 
Si besoin, r√©clamation aupr√®s de l‚Äôautorit√© de contr√¥le comp√©tente.

6) Cookies
Le site peut recourir √† des cookies techniques (indispensables) et, le cas √©ch√©ant, √† des cookies de mesure d‚Äôaudience/marketing. 
Le bandeau d‚Äôinformation permet d‚Äôexprimer un consentement granulaire. Le param√©trage du navigateur permet √©galement de les refuser.

7) Responsabilit√©
${d.entity} s‚Äôefforce d‚Äôassurer l‚Äôexactitude des informations publi√©es. Toutefois, des erreurs ou omissions peuvent survenir ; ${d.entity} ne saurait √™tre tenue responsable des cons√©quences d‚Äôune indisponibilit√© du site, d‚Äôun bug, ou d‚Äôune inexactitude.

8) Liens hypertextes
Le site peut contenir des liens vers des sites tiers. ${d.entity} d√©cline toute responsabilit√© quant √† leurs contenus et pratiques.

9) Droit applicable
Les pr√©sentes mentions sont soumises au droit ${d.law || "fran√ßais"} ; tout litige rel√®ve de ${court}.
`;

      /* CGV ‚Äî version pro compl√®te */
      const cgv = header("Conditions G√©n√©rales de Vente (CGV)") +
`1) D√©finitions
‚ÄúClient‚Äù : toute personne physique/ morale proc√©dant √† un achat sur ${site}. 
‚ÄúVendeur‚Äù : ${d.entity}. ‚ÄúProduits‚Äù/‚ÄúServices‚Äù : biens et/ou prestations propos√©s √† la vente.

2) Champ d‚Äôapplication
Les pr√©sentes CGV r√©gissent, sans restriction ni r√©serve, l‚Äôensemble des ventes conclues entre le Vendeur et le Client via ${site}. 
Toute commande implique l‚Äôacceptation pleine et enti√®re des CGV en vigueur au jour de la commande.

3) Produits & disponibilit√©
Les caract√©ristiques essentielles des Produits sont pr√©sent√©es sur le site. Les visuels n‚Äôont pas de valeur contractuelle. 
En cas d‚Äôindisponibilit√© apr√®s commande, le Client est inform√© et rembours√© sans d√©lai.

4) Prix
Les prix sont indiqu√©s en euros, toutes taxes comprises lorsque applicable. Les √©ventuels frais de livraison et options sont indiqu√©s avant validation de la commande.

5) Commande
Le Client suit le processus de commande en ligne (panier, identification, adresse, livraison, paiement). La validation finale vaut acceptation des prix, CGV et description des Produits. 
Le Vendeur se r√©serve le droit de refuser toute commande anormale, frauduleuse ou de mauvaise foi.

6) Paiement
Moyens de paiement accept√©s : ${d.payments || "CB, Visa, Mastercard"} (et autres moyens explicit√©s au checkout). 
Les paiements sont s√©curis√©s. Toute commande est payable comptant. 
Dans le cadre de la lutte contre la fraude, une proc√©dure 3-D Secure ou des v√©rifications compl√©mentaires peuvent √™tre requises.

7) Facturation
Une facture est √©mise et disponible sur demande. Le Client s‚Äôengage √† fournir des informations exactes.

8) Livraison
Zones desservies : ${d.zones || "France et UE"}.
D√©lais indicatifs d‚Äôexp√©dition : ${d.shippingDelay || "24‚Äì48h ouvr√©es"} via ${d.carriers || "transporteur(s) indiqu√©(s) lors du checkout"}.
Frais de livraison : ${d.fees || "affich√©s lors de la commande ; offerts au-del√† d‚Äôun certain montant le cas √©ch√©ant"}.
Le transfert des risques intervient √† la remise au Client (consommateur) ou au transporteur (professionnel).

9) R√©ception
Le Client doit v√©rifier l‚Äô√©tat du colis √† la livraison et √©mettre toutes r√©serves utiles aupr√®s du transporteur dans les d√©lais l√©gaux.

10) Droit de r√©tractation (consommateurs)
D√©lai : ${d.withdrawalDays || "14"} jours √† compter de la r√©ception.
Modalit√©s : notifier ${d.email} d‚Äôune d√©cision de r√©tractation non ambigu√´ (mod√®le en fin de CGV). 
Retour √† l‚Äôadresse : ${d.returnAddress || d.hqAddress}. Les Produits doivent √™tre intacts, complets, non utilis√©s, dans l‚Äôemballage d‚Äôorigine.
Exceptions : produits personnalis√©s, scell√©s ne pouvant √™tre renvoy√©s pour raisons d‚Äôhygi√®ne s‚Äôils ont √©t√© descell√©s, contenus num√©riques fournis sur support immat√©riel apr√®s ex√©cution.

11) Remboursement
Le Vendeur rembourse les sommes vers√©es, hors frais suppl√©mentaires de livraison express, au plus tard 14 jours √† compter de la r√©cup√©ration des Produits ou de la preuve d‚Äôexp√©dition.

12) Garanties l√©gales
Le Client b√©n√©ficie des garanties l√©gales de conformit√© et des vices cach√©s. Toute demande : ${d.email}. 
Le Vendeur ne saurait √™tre tenu responsable des dommages indirects.

13) Responsabilit√©
La responsabilit√© du Vendeur est limit√©e au montant de la commande litigieuse, sauf faute lourde ou dol.

14) Force majeure
Aucune partie n‚Äôest responsable en cas d‚Äô√©v√©nement impr√©visible, irr√©sistible et ext√©rieur emp√™chant l‚Äôex√©cution des obligations (force majeure).

15) Propri√©t√© intellectuelle
Tous √©l√©ments du site et des Produits restent la propri√©t√© exclusive du Vendeur ou de ses ayants droit.

16) Donn√©es personnelles
Traitements r√©alis√©s aux fins d‚Äôex√©cuter les commandes, g√©rer la relation client et pr√©venir la fraude. Droits RGPD : contacter ${d.dpo || d.email}.

17) M√©diation & RLL
En cas de litige non r√©solu, le Client consommateur peut recourir √† un m√©diateur de la consommation. 
Plateforme europ√©enne de R√®glement en Ligne des Litiges (RLL/ODR) : https://ec.europa.eu/consumers/odr/

18) Droit applicable ‚Äî Juridiction
Droit ${d.law || "fran√ßais"} ; juridiction : ${court}.

‚Äî Mod√®le de formulaire de r√©tractation ‚Äî
(√Ä compl√©ter et renvoyer si vous souhaitez vous r√©tracter du contrat)
√Ä l‚Äôattention de ${d.entity}, ${d.hqAddress}, ${d.email}
Je/Nous (*) vous notifie/notifions (*) par la pr√©sente ma/notre (*) r√©tractation du contrat portant sur la vente du bien (*)/pour la prestation de service (*) ci-dessous :
Command√© le (*)/re√ßu le (*): ‚Ä¶
Nom du/ des consommateur(s): ‚Ä¶
Adresse du/ des consommateur(s): ‚Ä¶
Signature du/ des consommateur(s) (en cas de notification sur papier): ‚Ä¶
Date: ‚Ä¶
(*) Rayez la mention inutile.
`;

      /* CGU ‚Äî version compl√®te */
      const cgu = header("Conditions G√©n√©rales d‚ÄôUtilisation (CGU)") +
`1) Objet
Les pr√©sentes CGU encadrent l‚Äôacc√®s et l‚Äôutilisation du site ${site}.

2) Acceptation
L‚Äôutilisation du site implique l‚Äôacceptation pleine et enti√®re des CGU en vigueur.

3) Acc√®s au site
Le site est accessible 24/7, sauf maintenance ou √©v√©nement hors contr√¥le. ${d.entity} ne garantit pas l‚Äôabsence d‚Äôinterruptions ou d‚Äôerreurs.

4) Compte utilisateur (le cas √©ch√©ant)
Le cas √©ch√©ant, l‚Äôutilisateur s‚Äôengage √† fournir des informations exactes et √† pr√©server la confidentialit√© de ses identifiants. Toute activit√© r√©alis√©e via le compte est r√©put√©e effectu√©e par lui.

5) Comportements interdits
Scraping massif, spamming, intrusion, contournement de mesures techniques, publication de contenus illicites ou portant atteinte aux droits de tiers.

6) Contenus
L‚Äôutilisateur demeure responsable des contenus qu‚Äôil publie. ${d.entity} peut retirer tout contenu contraire √† la loi ou aux pr√©sentes CGU.

7) Services tiers et liens externes
Le site peut int√©grer des services ou liens vers des sites tiers. ${d.entity} d√©cline toute responsabilit√© quant √† leur fonctionnement et contenus.

8) S√©curit√©
${d.entity} met en ≈ìuvre des mesures de s√©curit√© raisonnables. L‚Äôutilisateur s‚Äôengage √† signaler toute vuln√©rabilit√© pr√©sum√©e.

9) √âvolution du service
${d.entity} peut modifier les fonctionnalit√©s ou suspendre temporairement l‚Äôacc√®s pour maintenance.

10) Suspension ‚Äî R√©siliation
En cas de manquement aux CGU, ${d.entity} peut suspendre ou r√©silier l‚Äôacc√®s au site, de plein droit et sans indemnit√©.

11) Donn√©es personnelles ‚Äî Cookies
Voir Mentions l√©gales. Droits RGPD : ${d.dpo || d.email}. Gestion des cookies via le bandeau et le navigateur.

12) Propri√©t√© intellectuelle
Le site et ses √©l√©ments sont prot√©g√©s. Toute reproduction non autoris√©e est interdite.

13) Limitation de responsabilit√©
${d.entity} ne saurait √™tre tenue responsable des dommages indirects, perte de chance ou de donn√©es, dans les limites permises par la loi.

14) Preuve ‚Äî Archivage
Les enregistrements informatiques de ${d.entity} constituent des preuves opposables, sauf preuve contraire.

15) Droit applicable ‚Äî Juridiction
Droit ${d.law || "fran√ßais"} ; juridiction : ${court}.
`;

      /* SAV ‚Äî version d√©taill√©e */
      const sav = header("Service Apr√®s-Vente (SAV)") +
`1) Contact
‚Ä¢ Email : ${d.email}${tel!=="‚Äî"?`\n‚Ä¢ T√©l√©phone : ${tel}`:""}${d.savHours?`\n‚Ä¢ Horaires : ${d.savHours}`:""} 

2) Champ d‚Äôintervention
Assistance √† l‚Äôinstallation/usage, diagnostic des pannes, pi√®ces de remplacement, suivi des retours et √©changes.

3) Proc√©dure standard
${d.savProcess || `‚Ä¢ √âtape 1 ‚Äî Ouvrir un ticket : envoyer un email avec le num√©ro de commande, photos/vid√©os, description pr√©cise du probl√®me.
‚Ä¢ √âtape 2 ‚Äî Diagnostic : r√©ponse sous 24‚Äì48h ouvr√©es avec, si besoin, un num√©ro de dossier (RMA).
‚Ä¢ √âtape 3 ‚Äî Retour : le cas √©ch√©ant, instructions et √©tiquette de retour ; emballer soigneusement le produit complet et accessoires.`}

4) D√©lais de traitement
Diagnostic sous 48h ouvr√©es apr√®s r√©ception de toutes les informations n√©cessaires. R√©paration/√©change/remboursement sous d√©lai raisonnable selon disponibilit√© des pi√®ces.

5) Conditions de retour
Produits incomplets, endommag√©s par mauvaise utilisation, hors garantie ou sans preuve d‚Äôachat peuvent √™tre refus√©s.

6) Frais
Selon le cas : pris en charge par ${d.entity} en cas de d√©faut av√©r√© ; √† la charge du Client sinon.

7) Garanties
Application des garanties l√©gales de conformit√© et vices cach√©s. Extension de garantie si mentionn√©e sur la fiche produit.

8) Escalade ‚Äî M√©diation
En cas de d√©saccord, possibilit√© de m√©diation de la consommation et RLL/ODR : https://ec.europa.eu/consumers/odr/

9) Donn√©es personnelles
Les informations communiqu√©es au SAV sont trait√©es pour la gestion du dossier. Droits RGPD : ${d.dpo || d.email}.
`;

      const docs = [
        {key:'mentions', name:'Mentions l√©gales', text:mentions},
        {key:'cgv', name:'CGV', text:cgv},
        {key:'cgu', name:'CGU', text:cgu},
        {key:'sav', name:'SAV', text:sav},
      ];
      return { docs, meta:{ name, site, date } };
    }

    /* ====== LISTE + T√âL√âCHARGEMENTS ====== */
    function fillResults({docs, meta}){
      S.docList.innerHTML = '';
      docs.forEach(d=>{
        const item = document.createElement('div');
        item.className = 'doc-item';
        item.innerHTML = `
          <div>
            <div class="doc-title">${d.name}</div>
            <div class="hint">Pr√™t √† t√©l√©charger ‚Ä¢ ${meta.date}</div>
          </div>
          <div class="doc-actions">
            <button class="btn small ghost" data-action="preview">Aper√ßu</button>
            <button class="btn small primary" data-action="txt">.txt</button>
            <button class="btn small primary" data-action="pdf">.pdf</button>
          </div>
        `;
        const previewBtn = item.querySelector('[data-action="preview"]');
        const txtBtn = item.querySelector('[data-action="txt"]');
        const pdfBtn = item.querySelector('[data-action="pdf"]');

        previewBtn.addEventListener('click', ()=> openPreview(d.name, d.text));
        txtBtn.addEventListener('click', ()=> downloadTXT(filename(meta.name, d.key, 'txt'), d.text));
        pdfBtn.addEventListener('click', ()=> downloadPDF(filename(meta.name, d.key, 'pdf'), d.name, d.text));

        S.docList.appendChild(item);
      });
    }

    function filename(shop, key, ext){
      const slug = (shop||'boutique').toLowerCase().normalize('NFD').replace(/[\u0300-\u036f]/g,'').replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');
      return `${slug}_${key}.${ext}`;
    }

    function downloadTXT(name, text){
      const blob = new Blob([text], {type:'text/plain;charset=utf-8'});
      const url = URL.createObjectURL(blob);
      const a = document.createElement('a');
      a.href = url; a.download = name; a.click();
      URL.revokeObjectURL(url);
    }

    async function downloadPDF(name, title, text){
      const { jsPDF } = window.jspdf;
      const doc = new jsPDF({unit:'mm', format:'a4'});
      const margin = 15, lineHeight = 6.2, maxWidth = 180;
      doc.setFont('helvetica','bold'); doc.setFontSize(14);
      doc.text(title, margin, 18);
      doc.setFontSize(10);
      doc.setTextColor(120);
      doc.text(`G√©n√©r√© avec Infinie & gratuit ‚Äî ${new Date().toLocaleString('fr-FR')}`, margin, 24);
      doc.setDrawColor(180); doc.line(margin, 26, 210 - margin, 26);
      doc.setTextColor(0); doc.setFont('helvetica','normal'); doc.setFontSize(11);

      const lines = doc.splitTextToSize(text, maxWidth);
      let y = 34, page = 1;
      const footer = () => {
        doc.setFontSize(9); doc.setTextColor(120);
        doc.text(`Page ${page}`, 210 - margin, 297 - 10, {align:'right'});
        doc.setTextColor(0);
      };
      lines.forEach(line=>{
        if(y > 287){ footer(); doc.addPage(); page++; y = 18; }
        doc.text(line, margin, y); y += lineHeight;
      });
      footer();
      doc.save(name);
    }

    function openPreview(title, text){
      const w = window.open('', '_blank', 'noopener,noreferrer');
      const safe = text.replace(/&/g,'&amp;').replace(/</g,'&lt;').replace(/>/g,'&gt;');
      w.document.write(`<!doctype html><meta charset="utf-8"/>
        <title>${title} ‚Äî Aper√ßu</title>
        <style>
          body{margin:0;background:#0b0b0d;color:#e6ecf7;font-family:Inter,system-ui;padding:24px 18px}
          .box{max-width:860px;margin:0 auto;background:#0d1120;border:1px solid rgba(95,123,255,.18);border-radius:14px;padding:20px;white-space:pre-wrap;line-height:1.55}
          h1{font-size:20px;margin:0 0 10px}
          .bar{height:3px;background:linear-gradient(90deg,#2FE3FF,#1B4CFF);border-radius:99px;margin:8px 0 14px;opacity:.8}
        </style>
        <div class="box">
          <h1>${title}</h1>
          <div class="bar"></div>
          <div>${safe}</div>
        </div>`);
      w.document.close();
    }
  </script>
</body>
</html>
